# Basic File Exploit

In the first binary exploit challenge for the picoCTF 2022 CTF we are given a server to connect to and a .c file to look at. The .c file is of course the code to the challenge.

Open this up in your favorite editor. One of the first things we notice is that the flag is defined in the program, no file to be opened. Next we see the data array being setup as character (string), an input_lengths array of integers, and finally a variable called inputs set to 0.
![image](https://user-images.githubusercontent.com/6153549/161444587-ecb68a02-fde9-4670-bab6-e41e808ff388.png)

What I genearlly start with in these situations is look for the flag variable, in this case it was defined at the start, so somewhere in the program this variable must be used. A quick find and we see on line 145 that the flag is outputted as part of the data_read() function if the entry number matches 0. In the if statement at line 144 strtol is a C++ function that converts the first part of string to a long int, so this is saying if entry_number which is equal to the input is equal to 0 we will put the flag. 
![image](https://user-images.githubusercontent.com/6153549/161444622-71cebf87-79a5-4ef5-a07a-3616d7af5459.png)

So next we want to see where the data_read() function is being called. On line 185 we see that data_read() is called as part of a menu, if we select command 2 we can call the data read statement, but there is an if before this that if inputs=0 then we exit, so we have to first get the inputs to increment before we can call the data_read() function and put in 0 to get the flag. 
![image](https://user-images.githubusercontent.com/6153549/161444767-b36ca327-98a9-4d26-9dbb-1ef7f9730c96.png)

another quick look for inputs shows us on line 123 that inputs gets incremented at the end of the data_write() function. 
![image](https://user-images.githubusercontent.com/6153549/161444785-47fc5e52-28b0-4f02-ae79-421fd7196681.png)

So now we have all the piecese to solve this one. We need to connect, go to option 1 and input some random data, then go to option 2 and tell the program we want to output option 0.

![image](https://user-images.githubusercontent.com/6153549/161444885-33e8fb38-3e7d-472f-8f1a-eb1b267bf228.png)
